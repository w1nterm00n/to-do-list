(()=>{"use strict";const e={projects:[],currentPurpose:null};let t=function(e){let t=document.querySelector(".main_side");const o=document.querySelector(".to-do-line-closed").cloneNode(!0);o.style.display="block",t.appendChild(o),o.querySelector("#title_text").textContent=e.title,o.querySelector(".deadline").textContent=e.deadline;let r=o.querySelector(".toggle"),l=!1;r.addEventListener("click",(function(){!1===l?(n.style.display="block",d.setAttribute("src","pics/toggle_on.svg"),l=!0):(m(),l=!1)}));let n=document.createElement("div");n.className="description_and_priority_part",o.appendChild(n);let c=document.createElement("div");c.className="description_side",n.appendChild(c);let s=document.createElement("p");s.textContent="Description:",c.appendChild(s);let i=document.createElement("p");i.textContent=e.details,c.appendChild(i);let a=document.createElement("div");a.className="priority_side",n.appendChild(a);let u=document.createElement("p");u.textContent="Priority:",a.appendChild(u);let p=document.createElement("p");p.textContent=e.priority,a.appendChild(p);let d=r.querySelector("#toggleImg");function m(){n.style.display="none",d.setAttribute("src","pics/toggle_off.svg")}return m(),o};if(!localStorage.getItem("projects")){var o=JSON.stringify([{name:"Default Project",isActive:"true",purposes:[]}]);localStorage.setItem("projects",o)}const r=function(e,t){const o=Object.keys(e),r=Object.keys(t);if(o.length!==r.length)return!1;for(const r of o)if("isActive"!==r&&"purposes"!==r&&"DOM"!==r&&"isDone"!==r&&"object"==typeof e[r]&&"object"==typeof t[r]){if(!deepEqual(e[r],t[r]))return!1}else if("isActive"!==r&&"purposes"!==r&&"DOM"!==r&&"isDone"!==r&&e[r]!==t[r])return!1;return!0};!function(){document.querySelector(".addProjectBtn").addEventListener("click",(function(){l.showForm()}));let o=document.getElementById("projectForm");o.addEventListener("submit",(e=>{e.preventDefault(),l.submitForm(o)})),document.querySelector(".closeProjectBtn").addEventListener("click",(function(){l.hideForm()}));let l={formWrapper:document.querySelector(".pop-up_project_window"),showForm(){this.formWrapper.style.display="flex"},hideForm(){this.formWrapper.style.display="none"},submitForm(e){let t=this.serializeForm(e);this.hideForm(),s.createProject(t)},serializeForm(e){const{elements:t}=e;return Array.from(t).filter((e=>!!e.name)).map((function(e){const{name:t,value:o}=e;return{name:t,value:o}}))}};class n{constructor(t){this.name=t,this.isActive=!1,this.purposes=[],e.projects.push(this);var o=localStorage.getItem("projects"),l=JSON.parse(o),n=this,c=!0;l.forEach((function(e){r(e,n)&&(c=!1)})),c&&l.push(this);var s=JSON.stringify(l);localStorage.setItem("projects",s)}}let c={deletePurpose(t){let o=document.querySelector(".main_side");t.DOM.querySelector(".trash").addEventListener("click",(function(){o.removeChild(t.DOM);for(let o=0;o<e.projects.length;o++)if(1==e.projects[o].isActive){let c=e.projects[o].purposes.indexOf(t);if(-1!==c){e.projects[o].purposes.splice(c,1);var l=localStorage.getItem("projects"),n=JSON.parse(l);n.forEach((function(l){r(l,e.projects[o])&&(l.purposes.forEach((function(e){r(e,t)&&l.purposes.splice(c,1)})),localStorage.setItem("projects",JSON.stringify(n)))}))}}}))},changePurpose(t){t.DOM.querySelector(".change").addEventListener("click",(function(){let o=document.querySelector(".pop-up_purpose_window");o.style.display="flex";let r=o.querySelector(".title"),l=o.querySelector("#submit_btn"),n=o.querySelectorAll(".input");r.textContent="Change Form",l.textContent="Change",n.forEach((function(e){switch(e.id){case"title":e.value=t.title;break;case"deadline":e.value=t.deadline;break;case"details":e.value=t.details;break;case"priority":e.value=t.priority}})),e.currentPurpose=t}))}},s={createProject(e){let t=new n(e[0].value),o=i(t);o.querySelector(".trash").addEventListener("click",(function(){s.deleteProject(t,o)}))},deleteProject(t,o){for(let o=0;o<e.projects.length;o++)if(e.projects[o]==t){e.projects.splice(o,1);var l=localStorage.getItem("projects"),n=JSON.parse(l);n.forEach((function(e){if(r(t,e)){let t=n.indexOf(e);n.splice(t,1),localStorage.setItem("projects",JSON.stringify(n))}}))}document.querySelector(".projects_list").removeChild(o),projectName.textContent="deleted project";let c=document.querySelector(".main_side");c.querySelectorAll(".to-do-line").forEach((e=>{"block"===e.style.display&&c.removeChild(e)}))},creationOfStorageProjects(){var o=localStorage.getItem("projects"),l=JSON.parse(o);l.forEach((function(o){s.createProject([{value:o.name}]);let n=document.querySelector(".project_list"),i=n.querySelector(".toggle"),u={};e.projects.forEach((function(e){r(e,o)&&(u=e)})),o.purposes.forEach((function(e){u.purposes.push(e),e.DOM=t(e),c.deletePurpose(e),c.changePurpose(e);let o=e.DOM.querySelector("#todo-checkbox"),n=e.DOM.querySelector("#title_text");l.forEach((function(t){t.purposes.forEach((function(t){r(t,e)&&(!0===t.isDone?(n.style.color="grey",n.style.textDecoration="line-through",o.checked=!0):(n.style.color="black",n.style.textDecoration="none"))}))})),o.addEventListener("click",(function(){l.forEach((function(t){t.purposes.forEach((function(t){r(t,e)&&(!1===t.isDone?(n.style.color="grey",n.style.textDecoration="line-through",e.isDone=!0,t.isDone=!0):(e.isDone=!1,n.style.color="black",n.style.textDecoration="none",t.isDone=!1))}))}));var t=JSON.stringify(l);localStorage.setItem("projects",t)}))})),a.openToggle(i,n,o)}))},alwaysOpenFirstProject(){let t=e.projects[0],o=document.querySelector(".project_list"),r=o.querySelector(".toggle");a.openToggle(r,o,t);let l=document.querySelector(".toggle");l.click(),l.click()}},i=function(t){let o=document.querySelector(".projects_list"),r=document.createElement("div");r.classList.add("project_list"),o.appendChild(r);let l=document.createElement("button");l.classList.add("toggle"),r.appendChild(l);let n=document.createElement("img");n.classList.add("toggle_img"),n.setAttribute("src","pics/toggle_off.svg"),l.addEventListener("click",(function(){if(!1===a.isToggleOpen&&!1===t.isActive)a.openToggle(n,r,t);else if(!0===a.isToggleOpen&&!0===t.isActive)a.closeToggle(n,r,t);else if(!0===a.isToggleOpen&&!1===t.isActive)for(let l=0;l<e.projects.length;l++){if(!0===e.projects[l].isActive){e.projects[l].isActive=!1;let t=o.querySelectorAll(".project_list"),r=o.querySelectorAll(".toggle_img");t.forEach((e=>{e.style.background="rgba(172, 196, 204, 1)",e.style.border="none"})),r.forEach((e=>{e.setAttribute("src","pics/toggle_off.svg")}))}a.openToggle(n,r,t)}})),l.appendChild(n);let c=document.createElement("p");c.textContent=t.name,r.appendChild(c);let s=document.createElement("button");s.classList.add("trash"),r.appendChild(s);let i=document.createElement("img");return i.setAttribute("src","pics/trash.svg"),s.appendChild(i),r},a={isToggleOpen:!1,openToggle(e,t,o){this.isToggleOpen=!0,e.setAttribute("src","pics/toggle_on.svg"),t.style.background="#B49463",t.style.border="1px solid black",u.setProjectName(o.name),o.isActive=!0,u.purposeDisplaying(o)},closeToggle(e,t,o){this.isToggleOpen=!1,e.setAttribute("src","pics/toggle_off.svg"),t.style.background="rgba(172, 196, 204, 1)",t.style.border="none",o.isActive=!1}},u={projectName:document.getElementById("projectName"),mainSide:document.querySelector(".main_side"),purposeDisplaying(e){this.mainSide.querySelectorAll(".to-do-line").forEach((t=>{let o=t.querySelector("#title_text");0===e.purposes.length&&(t.style.display="none");for(let r=0;r<e.purposes.length;r++){if(e.purposes[r].title===o.textContent){t.style.display="block";break}t.style.display="none"}}))},setProjectName(e){this.projectName.textContent=e}};s.creationOfStorageProjects(),s.alwaysOpenFirstProject()}(),function(){document.querySelector(".addPurposeBtn").addEventListener("click",(function(){n.showEmptyForm()}));let o=document.getElementById("purposeForm");o.addEventListener("submit",(function(r){let l;r.preventDefault();let p=n.serializeForm(o);if(e.currentPurpose){l=e.currentPurpose,document.querySelector(".main_side").removeChild(l.DOM);let o=a(p);l.DOM=t(o),e.currentPurpose=null}else l=c(p),l.DOM=t(l);i(l),u(l),l.DOM.querySelector("#todo-checkbox").addEventListener("click",(function(){s(l)})),n.hideForm()})),document.querySelector(".closePurposetBtn").addEventListener("click",(function(){n.hideForm()}));let l=document.querySelector(".pop-up_purpose_window");e.currentPurpose=null;let n={title:l.querySelector(".title"),submitBtn:l.querySelector("#submit_btn"),formNodelist:l.querySelectorAll(".input"),showEmptyForm(){this.title.textContent="New Form",this.submitBtn.textContent="Add",this.formNodelist.forEach((function(e){e.value=""})),l.style.display="flex"},showFilledForm(t){e.currentPurpose=t,this.title.textContent="Change Form",this.submitBtn.textContent="Change",this.formNodelist.forEach((function(e){switch(e.id){case"title":e.value=t.title;break;case"deadline":e.value=t.deadline;break;case"details":e.value=t.details;break;case"priority":e.value=t.priority}})),l.style.display="flex"},hideForm(){l.style.display="none"},serializeForm(e){const{elements:t}=e;return Array.from(t).filter((e=>!!e.name)).map((function(e){const{name:t,value:o}=e;return{name:t,value:o}}))}},c=function(t){let o={isDone:!1};o.title=t[0].value,o.deadline=t[1].value,o.details=t[2].value,o.priority=t[3].value,o.DOM="";for(let t=0;t<e.projects.length;t++)if(1==e.projects[t].isActive){e.projects[t].purposes.push(o);var l=localStorage.getItem("projects"),n=JSON.parse(l);n.forEach((function(l){if(r(l,e.projects[t])){let e=n.findIndex((e=>e===l));-1!==e&&(n[e].purposes.push(o),localStorage.setItem("projects",JSON.stringify(n)))}}))}return o},s=function(e){let t=e.DOM.querySelector("#title_text");var o=localStorage.getItem("projects"),l=JSON.parse(o);l.forEach((function(o){o.purposes.forEach((function(o){r(o,e)&&(!1===o.isDone?(t.style.color="grey",t.style.textDecoration="line-through",e.isDone=!0,o.isDone=!0):(e.isDone=!1,t.style.color="black",t.style.textDecoration="none",o.isDone=!1))}))}));var n=JSON.stringify(l);localStorage.setItem("projects",n)},i=function(t){let o=document.querySelector(".main_side");t.DOM.querySelector(".trash").addEventListener("click",(function(){o.removeChild(t.DOM);for(let o=0;o<e.projects.length;o++)if(1==e.projects[o].isActive){let c=e.projects[o].purposes.indexOf(t);if(-1!==c){e.projects[o].purposes.splice(c,1);var l=localStorage.getItem("projects"),n=JSON.parse(l);n.forEach((function(l){r(l,e.projects[o])&&(l.purposes.forEach((function(e){r(e,t)&&l.purposes.splice(c,1)})),localStorage.setItem("projects",JSON.stringify(n)))}))}}}))},a=function(t){var o=localStorage.getItem("projects"),l=JSON.parse(o);return l.forEach((function(o){o.purposes.forEach((function(o){r(o,e.currentPurpose)&&(o.title=t[0].value,o.deadline=t[1].value,o.details=t[2].value,o.priority=t[3].value,localStorage.setItem("projects",JSON.stringify(l)))}))})),e.currentPurpose.title=t[0].value,e.currentPurpose.deadline=t[1].value,e.currentPurpose.details=t[2].value,e.currentPurpose.priority=t[3].value,e.currentPurpose},u=function(e){e.DOM.querySelector(".change").addEventListener("click",(function(){n.showFilledForm(e)}))}}()})();
//# sourceMappingURL=main.js.map